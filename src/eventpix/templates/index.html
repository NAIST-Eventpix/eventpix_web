<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="icon" href="/static/image/Logo.png">
	<link rel="stylesheet" href="/static/css/index.css">
	<title>Eventpix</title>

	<style>
		/* ローディング画面のスタイル */
		#loading-screen {
			position: fixed;
			width: 100%;
			height: 100%;
			background: rgba(255, 255, 255, 0.8);
			/* 半透明の白背景 */
			z-index: 1000;
			display: none;
			/* 最初は非表示 */
			justify-content: center;
			align-items: center;
		}

		#loading-screen img {
			width: 50px;
			height: 50px;
		}
	</style>
</head>

<body>
	<!-- ローディング画面 -->
	<div id="loading-screen">
		<img src="/static/image/loading.gif" alt="Loading...">
	</div>

	<header>
		<a class="logo" href="/">
			<img src="/static/image/logo.svg" alt="Logo">
			<span>Eventpix</span>
		</a>
	</header>
	<main>
		<section>
			<h1>画像の予定抽出</h1>
			<p>スケジュールの写真からカレンダー情報を抽出します<br/>抽出した情報はカレンダーアプリに反映できます</p>
			<form id="image-form" action="upload" method="POST" enctype="multipart/form-data">
				<label id="file-button-label" for="file-button">画像を選択</label>
				<input id="file-button" type="file" name="image" onchange="uploadImage(this)">
			</form>
			<p class="small">または，ここに画像をドラッグ＆ドロップしてください</p>
		</section>
	</main>
	<script src="/static/js/main.js"></script>
	<script>
		function uploadImage(input) {
			var formData = new FormData();
			var file = input.files[0];
			formData.append("image", file);

			// ローディング画面を表示
			document.getElementById('loading-screen').style.display = 'flex';

			// 画像をアップロードする処理（ここではサーバーにPOSTする例を示します）
			fetch('/upload', {
				method: 'POST',
				body: formData
			})
				.then(response => {
					// アップロードが完了したらローディング画面を非表示にする
					document.getElementById('loading-screen').style.display = 'none';
					// ここに成功時の処理を追加する（例えば、成功メッセージの表示など）
					console.log('アップロードが完了しました。');
				})
				.catch(error => {
					// エラー処理（ここでは簡易的にコンソールに出力）
					console.error('アップロード中にエラーが発生しました。', error);
					// エラー時もローディング画面を非表示にする
			document.getElementById('loading-screen').style.display = 'none';
		});
		}
	</script>
</body>

</html>