{% extends './base.html' %}

{% block title %}Eventpix{% endblock %}

{% block style %}
	<style>
		.hidden {
			display: none;
		}
		
		/* ローディング画面のスタイル */
		#loading-screen {
			position: fixed;
			width: 100%;
			height: 100%;
			background: rgba(255, 255, 255, 0.8);
			/* 半透明の白背景 */
			z-index: 1000;
			justify-content: center;
			align-items: center;
		}

		#loading-screen img {
			width: 50px;
			height: 50px;
		}
	</style>
{% endblock %}

{% block content %}
	<div id="loading-screen" class="hidden">
		<img src="{{ url_for('static', filename='image/loading.gif') }}" alt="Loading...">
	</div>

	<section>
		<h1>画像の予定抽出</h1>
		<p>スケジュールの写真からカレンダー情報を抽出します<br/>抽出した情報はカレンダーアプリに反映できます</p>
		<form id="image-form" action="upload" method="POST" enctype="multipart/form-data">
			<label id="file-button-label" for="file-button">画像を選択</label>
			<input id="file-button" type="file" name="image", onChange="uploadImage()">
		</form>
		<p class="small">または，ここに画像をドラッグ＆ドロップしてください</p>
	</section>
{% endblock %}

{% block script %}
	<script src="{{ url_for('static', filename='js/main.js') }}"></script>
	<script>
		function uploadImage() {
			console.log('ok');
			document.getElementById('loading-screen').classList.remove('hidden');

			// 画像をアップロードする処理（ここではサーバーにPOSTする例を示します）
			/*
			fetch('/upload', {
				method: 'POST',
				body: formData
			})
				.then(response => {
					// アップロードが完了したらローディング画面を非表示にする
					document.getElementById('loading-screen').style.display = 'none';
					// ここに成功時の処理を追加する（例えば、成功メッセージの表示など）
					console.log('アップロードが完了しました。');
				})
				.catch(error => {
					// エラー処理（ここでは簡易的にコンソールに出力）
					console.error('アップロード中にエラーが発生しました。', error);
					// エラー時もローディング画面を非表示にする
			document.getElementById('loading-screen').style.display = 'none';
			});
		*/
		}
	</script>
{% endblock %}
